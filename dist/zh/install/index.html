<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å®‰è£…æ•™ç¨‹ | DBAPI</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script>
          var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?a8fb326da5bdf70aa80eb56b11f97e0f";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
          })();
                
          </script>
    <meta name="description" content="Vue é©±åŠ¨çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨">
    
    <link rel="preload" href="/assets/css/0.styles.7be31436.css" as="style"><link rel="preload" href="/assets/js/app.5d88dc79.js" as="script"><link rel="preload" href="/assets/js/3.91e00d9f.js" as="script"><link rel="preload" href="/assets/js/15.538c5c8c.js" as="script"><link rel="prefetch" href="/assets/js/10.60af250e.js"><link rel="prefetch" href="/assets/js/11.f19c60e4.js"><link rel="prefetch" href="/assets/js/12.883416c4.js"><link rel="prefetch" href="/assets/js/13.c92fe683.js"><link rel="prefetch" href="/assets/js/14.6f481334.js"><link rel="prefetch" href="/assets/js/16.44b53986.js"><link rel="prefetch" href="/assets/js/4.7432690a.js"><link rel="prefetch" href="/assets/js/5.7487c1a0.js"><link rel="prefetch" href="/assets/js/6.ac85b528.js"><link rel="prefetch" href="/assets/js/7.3e46598f.js"><link rel="prefetch" href="/assets/js/8.c9600528.js"><link rel="prefetch" href="/assets/js/9.ee2a264a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5f89cefe.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7be31436.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zh/" class="home-link router-link-active"><!----> <span class="site-name">DBAPI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zh/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/zh/guide/" class="nav-link">
  æŒ‡å—
</a></div><div class="nav-item"><a href="/zh/install/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  å®‰è£…
</a></div><div class="nav-item"><a href="/zh/plugin/" class="nav-link">
  æ’ä»¶
</a></div><div class="nav-item"><a href="/zh/donate/" class="nav-link">
  ğŸ’–æ”¯æŒ
</a></div><div class="nav-item"><a href="https://gitee.com/freakchicken/db-api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/freakchick/DBApi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/install/" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/install/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ç®€ä½“ä¸­æ–‡
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zh/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/zh/guide/" class="nav-link">
  æŒ‡å—
</a></div><div class="nav-item"><a href="/zh/install/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  å®‰è£…
</a></div><div class="nav-item"><a href="/zh/plugin/" class="nav-link">
  æ’ä»¶
</a></div><div class="nav-item"><a href="/zh/donate/" class="nav-link">
  ğŸ’–æ”¯æŒ
</a></div><div class="nav-item"><a href="https://gitee.com/freakchicken/db-api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/freakchick/DBApi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/install/" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/install/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  ç®€ä½“ä¸­æ–‡
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å®‰è£…æ•™ç¨‹</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zh/install/#æœ¬åœ°éƒ¨ç½²å•æœºç‰ˆ" class="sidebar-link">æœ¬åœ°éƒ¨ç½²å•æœºç‰ˆ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zh/install/#æœ¬åœ°éƒ¨ç½²é›†ç¾¤ç‰ˆ" class="sidebar-link">æœ¬åœ°éƒ¨ç½²é›†ç¾¤ç‰ˆ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zh/install/#dockeréƒ¨ç½²å•æœºç‰ˆ" class="sidebar-link">dockeréƒ¨ç½²å•æœºç‰ˆ</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zh/install/#dockeréƒ¨ç½²é›†ç¾¤ç‰ˆ" class="sidebar-link">dockeréƒ¨ç½²é›†ç¾¤ç‰ˆ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/install/#å¯åŠ¨uiæœåŠ¡manager" class="sidebar-link">å¯åŠ¨UIæœåŠ¡manager</a></li><li class="sidebar-sub-header"><a href="/zh/install/#å¯åŠ¨ç½‘å…³æœåŠ¡-gateway" class="sidebar-link">å¯åŠ¨ç½‘å…³æœåŠ¡ gateway</a></li><li class="sidebar-sub-header"><a href="/zh/install/#å¯åŠ¨apiæœåŠ¡apiserver" class="sidebar-link">å¯åŠ¨APIæœåŠ¡apiServer</a></li></ul></li><li><a href="/zh/install/#é™„å½•" class="sidebar-link">é™„å½•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/install/#ç¯å¢ƒå˜é‡" class="sidebar-link">ç¯å¢ƒå˜é‡</a></li><li class="sidebar-sub-header"><a href="/zh/install/#dockerå¿«é€Ÿå®‰è£…nacos" class="sidebar-link">dockerå¿«é€Ÿå®‰è£…nacos</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="å®‰è£…æ•™ç¨‹"><a href="#å®‰è£…æ•™ç¨‹" class="header-anchor">#</a> å®‰è£…æ•™ç¨‹</h1> <blockquote><p>å®‰è£…åŒ…<a href="http://www.51dbapi.com/" target="_blank" rel="noopener noreferrer">ä¸‹è½½åœ°å€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ï¼Œæˆ–è€…åœ¨<a href="https://cloud.189.cn/t/Jza2MzeEZVNv" target="_blank" rel="noopener noreferrer">ç½‘ç›˜<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸‹è½½ã€‚é»˜è®¤è´¦æˆ·admin/adminã€‚</p></blockquote> <blockquote><p>ä¸ºäº†ä¾¿äºæ‚¨ç†è§£å®‰è£…çš„æ—¶å€™éœ€è¦é…ç½®çš„å‚æ•°å’Œdockerç¯å¢ƒå˜é‡ï¼Œè¯·æ‚¨å…ˆå­¦ä¹ <a href="/zh/guide/#ç›‘æ§">æ—¥å¿—ç›‘æ§</a>ç›¸å…³çš„åŠŸèƒ½è®¾è®¡</p></blockquote> <h2 id="æœ¬åœ°éƒ¨ç½²å•æœºç‰ˆ"><a href="#æœ¬åœ°éƒ¨ç½²å•æœºç‰ˆ" class="header-anchor">#</a> æœ¬åœ°éƒ¨ç½²å•æœºç‰ˆ</h2> <ul><li>ä¾èµ–javaç¯å¢ƒï¼Œå…ˆè‡ªè¡Œåœ¨æœåŠ¡å™¨å®‰è£…<code>jdk8+</code>ï¼Œå¹¶é…ç½®ç¯å¢ƒå˜é‡</li> <li>ä¸‹è½½å®‰è£…åŒ…è§£å‹åˆ°éœ€è¦å®‰è£…çš„ç›®å½•</li> <li>ä¿®æ”¹<code>conf/application.properties</code>æ–‡ä»¶ä¸­çš„ä»¥ä¸‹é…ç½®</li></ul> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment"># apiè®¿é—®è·¯å¾„çš„ç»Ÿä¸€æ ¹è·¯å¾„ï¼Œexample: http://192.168.xx.xx:8520/api/xxx</span>
<span class="token comment"># api context</span>
<span class="token key attr-name">dbapi.api.context</span><span class="token punctuation">=</span><span class="token value attr-value">api</span>

<span class="token comment"># å¦‚æœä¸ä¿®æ”¹æ•°æ®åº“åœ°å€å°†é»˜è®¤ä½¿ç”¨è‡ªå¸¦çš„å†…åµŒå…ƒæ•°æ®åº“sqlite</span>
<span class="token comment"># å…ƒæ•°æ®åº“åœ°å€ï¼Œå¯ä»¥ä½¿ç”¨mysqlæˆ–è€…è‡ªå¸¦çš„sqlite</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.meta-db.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">org.sqlite.JDBC</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.meta-db.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:sqlite::resource:sqlite.db</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.meta-db.username</span><span class="token punctuation">=</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.meta-db.password</span><span class="token punctuation">=</span>

<span class="token comment"># å°†APIè®¿é—®æ—¥å¿—å†™å…¥æ—¥å¿—æ•°æ®åº“ï¼ˆæ¨èclickhouseï¼‰çš„æ–¹å¼ï¼Œå€¼åªèƒ½æ˜¯db/kafka/null</span>
<span class="token comment"># dbä»£è¡¨dbapiç›´è¿æ—¥å¿—æ•°æ®åº“ï¼Œç›´æ¥å°†APIè®¿é—®æ—¥å¿—å†™å…¥æ—¥å¿—æ•°æ®åº“</span>
<span class="token comment"># kafkaä»£è¡¨dbapiå°†APIè®¿é—®æ—¥å¿—å†™å…¥kafkaï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œä»kafkaæ”¶é›†æ—¥å¿—å†™å…¥æ—¥å¿—æ•°æ®åº“</span>
<span class="token comment"># nullä»£è¡¨dbapiåªä¼šå°†APIè®¿é—®æ—¥å¿—å†™å…¥æœ¬åœ°ç£ç›˜æ–‡ä»¶ï¼ˆlogs/dbapi-access.logï¼‰ï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œä»ç£ç›˜æ–‡ä»¶æ”¶é›†æ—¥å¿—å†™å…¥æ—¥å¿—æ•°æ®åº“</span>
<span class="token key attr-name">access.log.writer</span><span class="token punctuation">=</span><span class="token value attr-value">null</span>

<span class="token comment"># æ—¥å¿—æ•°æ®åº“åœ°å€ï¼Œæ¨èä½¿ç”¨clickhouseï¼Œå¦‚æœæ‚¨ä¸éœ€è¦ä½¿ç”¨é¡µé¢ä¸Šçš„ç›‘æ§åŠŸèƒ½ï¼Œå¯ä»¥ä¸é…ç½®æ—¥å¿—æ•°æ®åº“åœ°å€</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.access-log-db.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">ru.yandex.clickhouse.ClickHouseDriver</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.access-log-db.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:clickhouse://127.0.0.1:8123/default</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.access-log-db.username</span><span class="token punctuation">=</span><span class="token value attr-value">default</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.access-log-db.password</span><span class="token punctuation">=</span><span class="token value attr-value">123456</span>

<span class="token comment"># å¦‚æœé…ç½®äº†access.log.writer=kafkaï¼Œé‚£ä¹ˆè¿˜éœ€è¦é…ç½®kafkaåœ°å€å’Œæ—¥å¿—å†™å…¥çš„topic</span>
<span class="token key attr-name">access.log.kafka.topic</span><span class="token punctuation">=</span><span class="token value attr-value">dbapi_access_log</span>
<span class="token key attr-name">spring.kafka.bootstrap-servers</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:9092</span>

</code></pre></div><blockquote><p>å¦‚æœé…ç½®äº†mysqlä½œä¸ºå…ƒæ•°æ®åº“ï¼Œè¯·å…ˆåœ¨mysqlæ‰§è¡Œåˆå§‹åŒ–è„šæœ¬<code>sql/ddl_mysql.sql</code>
å¦‚æœé…ç½®äº†æ—¥å¿—æ•°æ®åº“åœ°å€ï¼Œè¯·å…ˆåœ¨æ—¥å¿—æ•°æ®åº“æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬<code>sql/access_log_clickhouse.sql</code></p></blockquote> <ul><li>Linuxä¸€é”®å¯åœ</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sh</span> bin/dbapi-daemon.sh start standalone
<span class="token function">sh</span> bin/dbapi-daemon.sh stop standalone
</code></pre></div><ul><li>å¦‚æœæ˜¯windowsæ“ä½œç³»ç»Ÿè¯·å³é”®ç‚¹å‡»<code>bin/dbapi.ps1</code>æ–‡ä»¶ï¼Œé€‰æ‹©ä½¿ç”¨PowerShellè¿è¡Œ</li></ul> <blockquote><p>æ³¨æ„windowsç³»ç»Ÿåªæ”¯æŒstandaloneæ¨¡å¼è¿è¡Œï¼Œä¸æ”¯æŒé›†ç¾¤æ¨¡å¼</p></blockquote> <ul><li>æµè§ˆå™¨è®¿é—®<code>http://192.168.xx.xx:8520</code>è¿›å…¥UI</li></ul> <h2 id="æœ¬åœ°éƒ¨ç½²é›†ç¾¤ç‰ˆ"><a href="#æœ¬åœ°éƒ¨ç½²é›†ç¾¤ç‰ˆ" class="header-anchor">#</a> æœ¬åœ°éƒ¨ç½²é›†ç¾¤ç‰ˆ</h2> <ul><li>é›†ç¾¤éƒ¨ç½²ä¾èµ–<code>nacos</code>ã€<code>mysql</code>ã€<code>redis</code>ï¼Œè¯·å…ˆè‡ªè¡Œå®‰è£…<code>nacos</code>ï¼ˆæ¨è1.4.2ç‰ˆæœ¬ï¼‰ã€<code>mysql</code>ã€<code>redis</code></li> <li>å‡†å¤‡å¤šå°æœºå™¨ï¼Œæ¯å°å®‰è£…<code>jdk8+</code>å¹¶é…ç½®javaç¯å¢ƒå˜é‡</li> <li>é€‰ä¸€å°æœºå™¨host1ä½œä¸ºéƒ¨ç½²æœºï¼Œé…ç½®host1åˆ°å…¶ä»–æ¯å°æœºå™¨çš„sshå…å¯†ç™»å½•</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code>ssh-keygen <span class="token parameter variable">-t</span> rsa <span class="token parameter variable">-P</span> <span class="token string">''</span> <span class="token parameter variable">-f</span> ~/.ssh/id_rsa
<span class="token function">cat</span> ~/.ssh/id_rsa.pub <span class="token operator">&gt;&gt;</span> ~/.ssh/authorized_keys
<span class="token function">chmod</span> <span class="token number">600</span> ~/.ssh/authorized_keys

<span class="token keyword">for</span> <span class="token for-or-select variable">ip</span> <span class="token keyword">in</span> host2 host3<span class="token punctuation">;</span>     <span class="token comment"># è¯·å°†æ­¤å¤„ host2 host3 æ›¿æ¢ä¸ºè‡ªå·±è¦éƒ¨ç½²çš„æœºå™¨çš„ hostname</span>
<span class="token keyword">do</span>
  ssh-copy-id  <span class="token variable">$ip</span>   <span class="token comment"># è¯¥æ“ä½œæ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦æ‰‹åŠ¨è¾“å…¥éƒ¨ç½²ç”¨æˆ·çš„å¯†ç </span>
<span class="token keyword">done</span>
</code></pre></div><ul><li><p>ä¸‹è½½å®‰è£…åŒ…å¹¶è§£å‹åˆ°éƒ¨ç½²æœºhost1éœ€è¦å®‰è£…çš„ç›®å½•</p></li> <li><p>åœ¨mysqlåˆ›å»ºæ–°çš„æ•°æ®åº“ï¼Œå¹¶æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬<code>sql/ddl_mysql.sql</code></p></li> <li><p>ä¿®æ”¹<code>conf/application.properties</code>æ–‡ä»¶ä¸­çš„ä»¥ä¸‹é…ç½®</p></li></ul> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment">#################################### please config properties below #####################################</span>
<span class="token comment"># apiè®¿é—®è·¯å¾„çš„ç»Ÿä¸€æ ¹è·¯å¾„ï¼Œexample: http://192.168.xx.xx:8520/api/xxx</span>
<span class="token comment"># api context</span>
<span class="token key attr-name">dbapi.api.context</span><span class="token punctuation">=</span><span class="token value attr-value">api</span>

<span class="token comment"># å…ƒæ•°æ®åº“åœ°å€ï¼Œé›†ç¾¤ç‰ˆåªèƒ½ä½¿ç”¨mysql</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.meta-db.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.meta-db.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://127.0.0.1:3306/dbapi?useSSL=false&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.meta-db.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.meta-db.password</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>

<span class="token comment"># å°†APIè®¿é—®æ—¥å¿—å†™å…¥æ—¥å¿—æ•°æ®åº“ï¼ˆæ¨èclickhouseï¼‰çš„æ–¹å¼ï¼Œå€¼åªèƒ½æ˜¯db/kafka/null</span>
<span class="token comment"># dbä»£è¡¨dbapiç›´è¿æ—¥å¿—æ•°æ®åº“ï¼Œç›´æ¥å°†APIè®¿é—®æ—¥å¿—å†™å…¥æ—¥å¿—æ•°æ®åº“</span>
<span class="token comment"># kafkaä»£è¡¨dbapiå°†APIè®¿é—®æ—¥å¿—å†™å…¥kafkaï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œä»kafkaæ”¶é›†æ—¥å¿—å†™å…¥æ—¥å¿—æ•°æ®åº“</span>
<span class="token comment"># nullä»£è¡¨dbapiåªä¼šå°†APIè®¿é—®æ—¥å¿—å†™å…¥æœ¬åœ°ç£ç›˜æ–‡ä»¶ï¼ˆlogs/dbapi-access.logï¼‰ï¼Œç”¨æˆ·éœ€è¦è‡ªè¡Œä»ç£ç›˜æ–‡ä»¶æ”¶é›†æ—¥å¿—å†™å…¥æ—¥å¿—æ•°æ®åº“</span>
<span class="token key attr-name">access.log.writer</span><span class="token punctuation">=</span><span class="token value attr-value">null</span>

<span class="token comment"># æ—¥å¿—æ•°æ®åº“åœ°å€ï¼Œæ¨èä½¿ç”¨clickhouseï¼Œå¦‚æœæ‚¨ä¸éœ€è¦ä½¿ç”¨é¡µé¢ä¸Šçš„ç›‘æ§åŠŸèƒ½ï¼Œå¯ä»¥ä¸é…ç½®æ—¥å¿—æ•°æ®åº“åœ°å€</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.access-log-db.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">ru.yandex.clickhouse.ClickHouseDriver</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.access-log-db.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:clickhouse://127.0.0.1:8123/default</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.access-log-db.username</span><span class="token punctuation">=</span><span class="token value attr-value">default</span>
<span class="token key attr-name">spring.datasource.dynamic.datasource.access-log-db.password</span><span class="token punctuation">=</span><span class="token value attr-value">123456</span>

<span class="token comment"># å¦‚æœé…ç½®äº†access.log.writer=kafkaï¼Œé‚£ä¹ˆè¿˜éœ€è¦é…ç½®kafkaåœ°å€å’Œæ—¥å¿—å†™å…¥çš„topic</span>
<span class="token key attr-name">access.log.kafka.topic</span><span class="token punctuation">=</span><span class="token value attr-value">dbapi_access_log</span>
<span class="token key attr-name">spring.kafka.bootstrap-servers</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:9092</span>

<span class="token comment">############################## if cluster, please config properties below ##############################</span>

<span class="token comment"># nacos address, needed if cluster mode</span>
<span class="token key attr-name">spring.cloud.nacos.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:8848</span>
<span class="token key attr-name">spring.cloud.nacos.discovery.username</span><span class="token punctuation">=</span><span class="token value attr-value">nacos</span>
<span class="token key attr-name">spring.cloud.nacos.discovery.password</span><span class="token punctuation">=</span><span class="token value attr-value">nacos</span>
<span class="token key attr-name">spring.cloud.nacos.discovery.namespace</span><span class="token punctuation">=</span><span class="token value attr-value">public</span>

<span class="token comment"># redis address, needed if cluster mode</span>
<span class="token key attr-name">spring.redis.host</span><span class="token punctuation">=</span><span class="token value attr-value">localhost</span>
<span class="token key attr-name">spring.redis.port</span><span class="token punctuation">=</span><span class="token value attr-value">6379</span>
<span class="token key attr-name">spring.redis.database</span><span class="token punctuation">=</span><span class="token value attr-value">0</span>
<span class="token key attr-name">spring.redis.password</span><span class="token punctuation">=</span>

</code></pre></div><blockquote><p>å¦‚æœé…ç½®äº†æ—¥å¿—æ•°æ®åº“åœ°å€ï¼Œè¯·å…ˆåœ¨æ—¥å¿—æ•°æ®åº“æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬<code>sql/access_log_clickhouse.sql</code></p></blockquote> <ul><li>ä¿®æ”¹<code>conf/install_config.conf</code>æ–‡ä»¶ï¼Œé…ç½®è¦å®‰è£…çš„æœºå™¨èŠ‚ç‚¹</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># æ‰€æœ‰è¦å®‰è£…DBApiçš„ä¸»æœºipæˆ–hostnameï¼Œç”¨é€—å·åˆ†éš”</span>
<span class="token assign-left variable">ips</span><span class="token operator">=</span>host1,host2,host3

<span class="token assign-left variable">sshPort</span><span class="token operator">=</span><span class="token number">22</span>

<span class="token comment"># è¦å®‰è£…gatewayçš„ä¸»æœº</span>
<span class="token assign-left variable">gateway</span><span class="token operator">=</span>host1

<span class="token comment"># è¦å®‰è£…apiServerçš„ä¸»æœºï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”</span>
<span class="token assign-left variable">apiServers</span><span class="token operator">=</span>host1,host2,host3

<span class="token comment"># è¦å®‰è£…managerçš„ä¸»æœº</span>
<span class="token assign-left variable">manager</span><span class="token operator">=</span>host2
</code></pre></div><ul><li>æ‹·è´host1ä¸­çš„å®‰è£…æ–‡ä»¶åˆ°å…¶ä»–æ¯å°æœºå™¨çš„<strong>ç›¸åŒç›®å½•</strong>ï¼Œå¯ä½¿ç”¨è„šæœ¬ä¸€é”®æ‹·è´</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sh</span> bin/scp-host.sh
</code></pre></div><ul><li>é›†ç¾¤æ“ä½œè„šæœ¬</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># ä¸€é”®å¯åŠ¨é›†ç¾¤</span>
<span class="token function">sh</span> bin/start-all.sh

<span class="token comment"># ä¸€é”®åœæ­¢é›†ç¾¤</span>
<span class="token function">sh</span> bin/stop-all.sh

<span class="token comment"># æ‰‹åŠ¨å¯åœå•ä¸ªæœåŠ¡</span>
<span class="token function">sh</span> bin/dbapi-daemon.sh start gateway
<span class="token function">sh</span> bin/dbapi-daemon.sh start manager
<span class="token function">sh</span> bin/dbapi-daemon.sh start apiServer

<span class="token function">sh</span> bin/dbapi-daemon.sh stop gateway
<span class="token function">sh</span> bin/dbapi-daemon.sh stop manager
<span class="token function">sh</span> bin/dbapi-daemon.sh stop apiServer

</code></pre></div><ul><li>æµè§ˆå™¨è®¿é—®<code>http://192.168.xx.xx:8523</code>è¿›å…¥UI; APIé€šè¿‡gatewayæ¥è®¿é—®<code>http://192.168.xx.xx:8525/api/xx</code></li></ul> <h2 id="dockeréƒ¨ç½²å•æœºç‰ˆ"><a href="#dockeréƒ¨ç½²å•æœºç‰ˆ" class="header-anchor">#</a> dockeréƒ¨ç½²å•æœºç‰ˆ</h2> <blockquote><p>å»ºè®®å…ˆé˜…è¯»<a href="/zh/guide/#ç›‘æ§">æ—¥å¿—ç›‘æ§</a>ï¼Œä¾¿äºç†è§£dockeræ¯ä¸ªç¯å¢ƒå˜é‡çš„å«ä¹‰ï¼Œç†è§£å¯åŠ¨çš„æ—¶å€™æ˜¯å¦éœ€è¦é…ç½®ç›¸åº”çš„ç¯å¢ƒå˜é‡</p></blockquote> <blockquote><p>Docker å®¹å™¨é€šè¿‡ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ï¼Œ<a href="/zh/install/#ç¯å¢ƒå˜é‡">é™„å½•-ç¯å¢ƒå˜é‡</a>åˆ—å‡ºäº† <code>DBApi</code> çš„å¯é…ç½®ç¯å¢ƒå˜é‡åŠå…¶é»˜è®¤å€¼</p></blockquote> <ul><li>ä¸€é”®å¯åŠ¨ï¼ˆä½¿ç”¨dbapiè‡ªå¸¦çš„å…ƒæ•°æ®åº“sqliteï¼Œä¸”ä¸èƒ½ä½¿ç”¨æ—¥å¿—ç›‘æ§åŠŸèƒ½ï¼‰</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">-p</span> <span class="token number">8520</span>:8520 <span class="token parameter variable">--name</span> dbapi freakchicken/db-api:3.2.0 standalone
</code></pre></div><ul><li>å¦‚æœéœ€è¦ä½¿ç”¨ç›‘æ§åŠŸèƒ½ï¼Œè¿˜è¦é…ç½®æ—¥å¿—æ•°æ®åº“åœ°å€ï¼Œä»¥åŠå°†æ—¥å¿—å†™å…¥æ—¥å¿—æ•°æ®åº“</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">8520</span>:8520 <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ACCESS_LOG_WRITER</span><span class="token operator">=</span><span class="token string">&quot;db&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:clickhouse://127.0.0.1:8123/default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;123456&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;ru.yandex.clickhouse.ClickHouseDriver&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">--name</span> dbapi <span class="token punctuation">\</span>
freakchicken/db-api:3.2.0 standalone
</code></pre></div><ul><li>å¦‚æœä½¿ç”¨è‡ªå·±çš„mysqlä½œä¸ºå…ƒæ•°æ®åº“ï¼ˆå¯åŠ¨å‰éœ€è¦åœ¨mysqlæ‰§è¡Œåˆå§‹åŒ–è„šæœ¬ï¼‰</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">8520</span>:8520 <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;com.mysql.cj.jdbc.Driver&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ACCESS_LOG_WRITER</span><span class="token operator">=</span><span class="token string">&quot;db&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:clickhouse://127.0.0.1:8123/default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;123456&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;ru.yandex.clickhouse.ClickHouseDriver&quot;</span> <span class="token punctuation">\</span>
freakchicken/db-api:3.2.0 standalone
</code></pre></div><ul><li>å¦‚æœéœ€è¦å°†APIè®¿é—®æ—¥å¿—å†™å…¥kafkaï¼Œè¿˜éœ€è¦é…ç½®kafkaç›¸å…³é…ç½®</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">8520</span>:8520 <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;com.mysql.cj.jdbc.Driver&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ACCESS_LOG_WRITER</span><span class="token operator">=</span><span class="token string">&quot;kafka&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ACCESS_LOG_KAFKA_TOPIC</span><span class="token operator">=</span><span class="token string">&quot;dbapi_access_log&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ACCESS_LOG_KAFKA</span><span class="token operator">=</span><span class="token string">&quot;127.0.0.1:9092&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:clickhouse://127.0.0.1:8123/default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;123456&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;ru.yandex.clickhouse.ClickHouseDriver&quot;</span> <span class="token punctuation">\</span>
freakchicken/db-api:3.2.0 standalone
</code></pre></div><ul><li>æµè§ˆå™¨è®¿é—®<code>http://192.168.xx.xx:8520</code>è¿›å…¥UI</li></ul> <h2 id="dockeréƒ¨ç½²é›†ç¾¤ç‰ˆ"><a href="#dockeréƒ¨ç½²é›†ç¾¤ç‰ˆ" class="header-anchor">#</a> dockeréƒ¨ç½²é›†ç¾¤ç‰ˆ</h2> <blockquote><p>å»ºè®®å…ˆé˜…è¯»<a href="/zh/guide/#ç›‘æ§">æ—¥å¿—ç›‘æ§</a>ï¼Œä¾¿äºç†è§£dockeræ¯ä¸ªç¯å¢ƒå˜é‡çš„å«ä¹‰ï¼Œç†è§£å¯åŠ¨çš„æ—¶å€™æ˜¯å¦éœ€è¦é…ç½®ç›¸åº”çš„ç¯å¢ƒå˜é‡</p></blockquote> <blockquote><p>Docker å®¹å™¨é€šè¿‡ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ï¼Œ<a href="/zh/install/#ç¯å¢ƒå˜é‡">é™„å½•-ç¯å¢ƒå˜é‡</a>åˆ—å‡ºäº† <code>DBApi</code> çš„å¯é…ç½®ç¯å¢ƒå˜é‡åŠå…¶é»˜è®¤å€¼</p></blockquote> <ul><li>é›†ç¾¤éƒ¨ç½²ä¾èµ–<code>nacos</code>ã€<code>mysql</code>ã€<code>redis</code>ï¼Œè¯·å…ˆè‡ªè¡Œå®‰è£…<code>nacos</code>ï¼ˆæ¨è1.4.2ç‰ˆæœ¬ï¼‰ã€<code>mysql</code>ã€<code>redis</code></li> <li>åœ¨mysqlåˆ›å»ºæ–°çš„æ•°æ®åº“ï¼Œæ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆä¸‹è½½å®‰è£…åŒ…è§£å‹è·å–<code>sql/ddl_mysql.sql</code>è„šæœ¬ï¼‰</li></ul> <h3 id="å¯åŠ¨uiæœåŠ¡manager"><a href="#å¯åŠ¨uiæœåŠ¡manager" class="header-anchor">#</a> å¯åŠ¨UIæœåŠ¡manager</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">8523</span>:8523 <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;com.mysql.cj.jdbc.Driver&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_ADDRESS</span><span class="token operator">=</span><span class="token string">&quot;192.168.xx.xx:8848&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;nacos&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;nacos&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_NAMESPACE</span><span class="token operator">=</span><span class="token string">&quot;public&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_HOST</span><span class="token operator">=</span><span class="token string">&quot;127.0.0.1&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_PORT</span><span class="token operator">=</span><span class="token number">6379</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_DATABASE</span><span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:clickhouse://127.0.0.1:8123/default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;123456&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;ru.yandex.clickhouse.ClickHouseDriver&quot;</span> <span class="token punctuation">\</span>
freakchicken/db-api:3.2.0 manager
</code></pre></div><h3 id="å¯åŠ¨ç½‘å…³æœåŠ¡-gateway"><a href="#å¯åŠ¨ç½‘å…³æœåŠ¡-gateway" class="header-anchor">#</a> å¯åŠ¨ç½‘å…³æœåŠ¡ gateway</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-p</span> <span class="token number">8525</span>:8525 <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;com.mysql.cj.jdbc.Driver&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_ADDRESS</span><span class="token operator">=</span><span class="token string">&quot;192.168.xx.xx:8848&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;nacos&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;nacos&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_NAMESPACE</span><span class="token operator">=</span><span class="token string">&quot;public&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_HOST</span><span class="token operator">=</span><span class="token string">&quot;127.0.0.1&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_PORT</span><span class="token operator">=</span><span class="token number">6379</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_DATABASE</span><span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token punctuation">\</span>
freakchicken/db-api:3.2.0 gateway
</code></pre></div><h3 id="å¯åŠ¨apiæœåŠ¡apiserver"><a href="#å¯åŠ¨apiæœåŠ¡apiserver" class="header-anchor">#</a> å¯åŠ¨APIæœåŠ¡apiServer</h3> <blockquote><p>æ­¤æœåŠ¡å¯å¯åŠ¨å¤šä¸ªï¼Œæ„å»ºapié›†ç¾¤</p></blockquote> <ul><li>APIè®¿é—®æ—¥å¿—ç›´æ¥å†™å…¥æ—¥å¿—æ•°æ®åº“æ–¹å¼</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;com.mysql.cj.jdbc.Driver&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_ADDRESS</span><span class="token operator">=</span><span class="token string">&quot;192.168.xx.xx:8848&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;nacos&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;nacos&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_NAMESPACE</span><span class="token operator">=</span><span class="token string">&quot;public&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_HOST</span><span class="token operator">=</span><span class="token string">&quot;127.0.0.1&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_PORT</span><span class="token operator">=</span><span class="token number">6379</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_DATABASE</span><span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ACCESS_LOG_WRITER</span><span class="token operator">=</span><span class="token string">&quot;db&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:clickhouse://127.0.0.1:8123/default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;123456&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;ru.yandex.clickhouse.ClickHouseDriver&quot;</span> <span class="token punctuation">\</span>
freakchicken/db-api:3.2.0 apiServer
</code></pre></div><ul><li>å¦‚æœéœ€è¦å°†APIè®¿é—®æ—¥å¿—å†™å…¥kafkaï¼Œè¿˜éœ€è¦é…ç½®kafkaç›¸å…³é…ç½®</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;com.mysql.cj.jdbc.Driver&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_ADDRESS</span><span class="token operator">=</span><span class="token string">&quot;192.168.xx.xx:8848&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;nacos&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;nacos&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">NACOS_NAMESPACE</span><span class="token operator">=</span><span class="token string">&quot;public&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_HOST</span><span class="token operator">=</span><span class="token string">&quot;127.0.0.1&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_PORT</span><span class="token operator">=</span><span class="token number">6379</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_DATABASE</span><span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">REDIS_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ACCESS_LOG_WRITER</span><span class="token operator">=</span><span class="token string">&quot;kafka&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ACCESS_LOG_KAFKA_TOPIC</span><span class="token operator">=</span><span class="token string">&quot;dbapi_access_log&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">ACCESS_LOG_KAFKA</span><span class="token operator">=</span><span class="token string">&quot;127.0.0.1:9092&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_URL</span><span class="token operator">=</span><span class="token string">&quot;jdbc:clickhouse://127.0.0.1:8123/default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_USERNAME</span><span class="token operator">=</span><span class="token string">&quot;default&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_PASSWORD</span><span class="token operator">=</span><span class="token string">&quot;123456&quot;</span> <span class="token punctuation">\</span>
<span class="token parameter variable">-e</span> <span class="token assign-left variable">LOG_DB_DRIVER</span><span class="token operator">=</span><span class="token string">&quot;ru.yandex.clickhouse.ClickHouseDriver&quot;</span> <span class="token punctuation">\</span>
freakchicken/db-api:3.2.0 apiServer
</code></pre></div><ul><li>æµè§ˆå™¨è®¿é—®<code>http://192.168.xx.xx:8523</code>è¿›å…¥UI; APIé€šè¿‡gatewayæ¥è®¿é—®<code>http://192.168.xx.xx:8525/api/xx</code></li></ul> <h2 id="é™„å½•"><a href="#é™„å½•" class="header-anchor">#</a> é™„å½•</h2> <h3 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="header-anchor">#</a> ç¯å¢ƒå˜é‡</h3> <blockquote><p>Dockeréƒ¨ç½²çš„æ—¶å€™é€šè¿‡ä»¥ä¸‹ç¯å¢ƒå˜é‡æ¥ä¼ é€’å‚æ•°</p></blockquote> <table><thead><tr><th>ç¯å¢ƒå˜é‡</th> <th>é»˜è®¤å€¼</th> <th>è¯´æ˜</th></tr></thead> <tbody><tr><td>API_CONTEXT</td> <td>api</td> <td>æ‰€æœ‰APIçš„ç»Ÿä¸€æ ¹è·¯å¾„</td></tr> <tr><td>DB_URL</td> <td>jdbc:sqlite::resource:sqlite.db</td> <td>å…ƒæ•°æ®åº“åœ°å€</td></tr> <tr><td>DB_USERNAME</td> <td></td> <td>å…ƒæ•°æ®åº“è´¦æˆ·</td></tr> <tr><td>DB_PASSWORD</td> <td></td> <td>å…ƒæ•°æ®åº“å¯†ç </td></tr> <tr><td>DB_DRIVER</td> <td>org.sqlite.JDBC</td> <td>å…ƒæ•°æ®åº“åœ°å€jdbcé©±åŠ¨</td></tr> <tr><td>NACOS_ADDRESS</td> <td>127.0.0.1:8848</td> <td>é›†ç¾¤æ¨¡å¼ä½¿ç”¨çš„nacosåœ°å€</td></tr> <tr><td>NACOS_USERNAME</td> <td>nacos</td> <td>é›†ç¾¤æ¨¡å¼ä½¿ç”¨çš„nacosè´¦æˆ·</td></tr> <tr><td>NACOS_PASSWORD</td> <td>nacos</td> <td>é›†ç¾¤æ¨¡å¼ä½¿ç”¨çš„nacoså¯†ç </td></tr> <tr><td>NACOS_NAMESPACE</td> <td>public</td> <td>é›†ç¾¤æ¨¡å¼ä½¿ç”¨çš„nacos namespace</td></tr> <tr><td>REDIS_HOST</td> <td>127.0.0.1</td> <td>é›†ç¾¤æ¨¡å¼ä½¿ç”¨çš„redisåœ°å€</td></tr> <tr><td>REDIS_PORT</td> <td>6379</td> <td>é›†ç¾¤æ¨¡å¼ä½¿ç”¨çš„redisç«¯å£</td></tr> <tr><td>REDIS_DATABASE</td> <td>0</td> <td>é›†ç¾¤æ¨¡å¼ä½¿ç”¨çš„redisæ•°æ®åº“å·</td></tr> <tr><td>REDIS_PASSWORD</td> <td></td> <td>é›†ç¾¤æ¨¡å¼ä½¿ç”¨çš„rediså¯†ç </td></tr> <tr><td>LOG_DB_URL</td> <td>jdbc:clickhouse://127.0.0.1:8123/default</td> <td>æ—¥å¿—æ•°æ®åº“åœ°å€</td></tr> <tr><td>LOG_DB_USERNAME</td> <td>default</td> <td>æ—¥å¿—æ•°æ®åº“è´¦æˆ·</td></tr> <tr><td>LOG_DB_PASSWORD</td> <td>123456</td> <td>æ—¥å¿—æ•°æ®åº“å¯†ç </td></tr> <tr><td>LOG_DB_DRIVER</td> <td>ru.yandex.clickhouse.ClickHouseDriver</td> <td>æ—¥å¿—æ•°æ®åº“åœ°å€jdbcé©±åŠ¨</td></tr> <tr><td>ACCESS_LOG_WRITER</td> <td>null</td> <td>APIè®¿é—®æ—¥å¿—å†™å…¥æ•°æ®åº“çš„æ–¹å¼</td></tr> <tr><td>ACCESS_LOG_KAFKA_TOPIC</td> <td>dbapi_access_log</td> <td>APIè®¿é—®æ—¥å¿—å†™å…¥çš„Kafkaçš„topic</td></tr> <tr><td>ACCESS_LOG_KAFKA</td> <td>127.0.0.1:9092</td> <td>APIè®¿é—®æ—¥å¿—å†™å…¥çš„Kafkaçš„åœ°å€</td></tr></tbody></table> <h3 id="dockerå¿«é€Ÿå®‰è£…nacos"><a href="#dockerå¿«é€Ÿå®‰è£…nacos" class="header-anchor">#</a> dockerå¿«é€Ÿå®‰è£…nacos</h3> <div class="language- extra-class"><pre class="language-text"><code>docker run --env MODE=standalone --name nacos -d -p 8848:8848 nacos/nacos-server:1.4.2
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5d88dc79.js" defer></script><script src="/assets/js/3.91e00d9f.js" defer></script><script src="/assets/js/15.538c5c8c.js" defer></script>
  </body>
</html>
