(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{290:function(a,s,t){"use strict";t.r(s);var e=t(14),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"安装教程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装教程"}},[a._v("#")]),a._v(" 安装教程")]),a._v(" "),s("blockquote",[s("p",[a._v("安装包"),s("a",{attrs:{href:"http://www.51dbapi.com/",target:"_blank",rel:"noopener noreferrer"}},[a._v("下载地址"),s("OutboundLink")],1),a._v(" ，或者在"),s("a",{attrs:{href:"https://cloud.189.cn/t/Jza2MzeEZVNv",target:"_blank",rel:"noopener noreferrer"}},[a._v("网盘"),s("OutboundLink")],1),a._v(" 下载。默认账户admin/admin。")])]),a._v(" "),s("blockquote",[s("p",[a._v("为了便于您理解安装的时候需要配置的参数和docker环境变量，请您先学习"),s("RouterLink",{attrs:{to:"/zh/guide/#监控"}},[a._v("日志监控")]),a._v("相关的功能设计")],1)]),a._v(" "),s("h2",{attrs:{id:"本地部署单机版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#本地部署单机版"}},[a._v("#")]),a._v(" 本地部署单机版")]),a._v(" "),s("ul",[s("li",[a._v("依赖java环境，先自行在服务器安装"),s("code",[a._v("jdk8+")]),a._v("，并配置环境变量")]),a._v(" "),s("li",[a._v("下载安装包解压到需要安装的目录")]),a._v(" "),s("li",[a._v("修改"),s("code",[a._v("conf/application.properties")]),a._v("文件中的以下配置")])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# api访问路径的统一根路径，example: http://192.168.xx.xx:8520/api/xxx")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# api context")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("dbapi.api.context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("api")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 如果不修改数据库地址将默认使用自带的内嵌元数据库sqlite")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 元数据库地址，可以使用mysql或者自带的sqlite")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.meta-db.driver-class-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("org.sqlite.JDBC")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.meta-db.url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jdbc:sqlite::resource:sqlite.db")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.meta-db.username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.meta-db.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将API访问日志写入日志数据库（推荐clickhouse）的方式，值只能是db/kafka/null")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# db代表dbapi直连日志数据库，直接将API访问日志写入日志数据库")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# kafka代表dbapi将API访问日志写入kafka，用户需要自行从kafka收集日志写入日志数据库")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# null代表dbapi只会将API访问日志写入本地磁盘文件（logs/dbapi-access.log），用户需要自行从磁盘文件收集日志写入日志数据库")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("access.log.writer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("null")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 日志数据库地址，推荐使用clickhouse，如果您不需要使用页面上的监控功能，可以不配置日志数据库地址")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.access-log-db.driver-class-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ru.yandex.clickhouse.ClickHouseDriver")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.access-log-db.url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jdbc:clickhouse://127.0.0.1:8123/default")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.access-log-db.username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.access-log-db.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("123456")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 如果配置了access.log.writer=kafka，那么还需要配置kafka地址和日志写入的topic")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("access.log.kafka.topic")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("dbapi_access_log")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.kafka.bootstrap-servers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("127.0.0.1:9092")]),a._v("\n\n")])])]),s("blockquote",[s("p",[a._v("如果配置了mysql作为元数据库，请先在mysql执行初始化脚本"),s("code",[a._v("sql/ddl_mysql.sql")]),a._v("\n如果配置了日志数据库地址，请先在日志数据库执行初始化脚本"),s("code",[a._v("sql/access_log_clickhouse.sql")])])]),a._v(" "),s("ul",[s("li",[a._v("Linux一键启停")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/dbapi-daemon.sh start standalone\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/dbapi-daemon.sh stop standalone\n")])])]),s("ul",[s("li",[a._v("如果是windows操作系统请右键点击"),s("code",[a._v("bin/dbapi.ps1")]),a._v("文件，选择使用PowerShell运行")])]),a._v(" "),s("blockquote",[s("p",[a._v("注意windows系统只支持standalone模式运行，不支持集群模式")])]),a._v(" "),s("ul",[s("li",[a._v("浏览器访问"),s("code",[a._v("http://192.168.xx.xx:8520")]),a._v("进入UI")])]),a._v(" "),s("h2",{attrs:{id:"本地部署集群版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#本地部署集群版"}},[a._v("#")]),a._v(" 本地部署集群版")]),a._v(" "),s("ul",[s("li",[a._v("集群部署依赖"),s("code",[a._v("nacos")]),a._v("、"),s("code",[a._v("mysql")]),a._v("、"),s("code",[a._v("redis")]),a._v("，请先自行安装"),s("code",[a._v("nacos")]),a._v("（推荐1.4.2版本）、"),s("code",[a._v("mysql")]),a._v("、"),s("code",[a._v("redis")])]),a._v(" "),s("li",[a._v("准备多台机器，每台安装"),s("code",[a._v("jdk8+")]),a._v("并配置java环境变量")]),a._v(" "),s("li",[a._v("选一台机器host1作为部署机，配置host1到其他每台机器的ssh免密登录")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("ssh-keygen "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" rsa "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-P")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" ~/.ssh/id_rsa\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" ~/.ssh/id_rsa.pub "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">>")]),a._v(" ~/.ssh/authorized_keys\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("600")]),a._v(" ~/.ssh/authorized_keys\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[a._v("ip")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" host2 host3"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("     "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 请将此处 host2 host3 替换为自己要部署的机器的 hostname")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n  ssh-copy-id  "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$ip")]),a._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 该操作执行过程中需要手动输入部署用户的密码")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("done")]),a._v("\n")])])]),s("ul",[s("li",[s("p",[a._v("下载安装包并解压到部署机host1需要安装的目录")])]),a._v(" "),s("li",[s("p",[a._v("在mysql创建新的数据库，并执行初始化脚本"),s("code",[a._v("sql/ddl_mysql.sql")])])]),a._v(" "),s("li",[s("p",[a._v("修改"),s("code",[a._v("conf/application.properties")]),a._v("文件中的以下配置")])])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#################################### please config properties below #####################################")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# api访问路径的统一根路径，example: http://192.168.xx.xx:8520/api/xxx")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# api context")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("dbapi.api.context")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("api")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 元数据库地址，集群版只能使用mysql")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.meta-db.driver-class-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("com.mysql.cj.jdbc.Driver")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.meta-db.url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jdbc:mysql://127.0.0.1:3306/dbapi?useSSL=false&characterEncoding=UTF-8&serverTimezone=GMT%2B8")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.meta-db.username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("root")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.meta-db.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("root")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将API访问日志写入日志数据库（推荐clickhouse）的方式，值只能是db/kafka/null")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# db代表dbapi直连日志数据库，直接将API访问日志写入日志数据库")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# kafka代表dbapi将API访问日志写入kafka，用户需要自行从kafka收集日志写入日志数据库")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# null代表dbapi只会将API访问日志写入本地磁盘文件（logs/dbapi-access.log），用户需要自行从磁盘文件收集日志写入日志数据库")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("access.log.writer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("null")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 日志数据库地址，推荐使用clickhouse，如果您不需要使用页面上的监控功能，可以不配置日志数据库地址")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.access-log-db.driver-class-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("ru.yandex.clickhouse.ClickHouseDriver")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.access-log-db.url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jdbc:clickhouse://127.0.0.1:8123/default")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.access-log-db.username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.datasource.dynamic.datasource.access-log-db.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("123456")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 如果配置了access.log.writer=kafka，那么还需要配置kafka地址和日志写入的topic")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("access.log.kafka.topic")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("dbapi_access_log")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.kafka.bootstrap-servers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("127.0.0.1:9092")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("############################## if cluster, please config properties below ##############################")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# nacos address, needed if cluster mode")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.cloud.nacos.server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("127.0.0.1:8848")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.cloud.nacos.discovery.username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("nacos")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.cloud.nacos.discovery.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("nacos")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.cloud.nacos.discovery.namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("public")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# redis address, needed if cluster mode")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.redis.host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("localhost")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.redis.port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("6379")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.redis.database")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("0")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.redis.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n\n")])])]),s("blockquote",[s("p",[a._v("如果配置了日志数据库地址，请先在日志数据库执行初始化脚本"),s("code",[a._v("sql/access_log_clickhouse.sql")])])]),a._v(" "),s("ul",[s("li",[a._v("修改"),s("code",[a._v("conf/install_config.conf")]),a._v("文件，配置要安装的机器节点")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 所有要安装DBApi的主机ip或hostname，用逗号分隔")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ips")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("host1,host2,host3\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("sshPort")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 要安装gateway的主机")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("gateway")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("host1\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 要安装apiServer的主机，多个用逗号分隔")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("apiServers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("host1,host2,host3\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 要安装manager的主机")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("manager")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("host2\n")])])]),s("ul",[s("li",[a._v("拷贝host1中的安装文件到其他每台机器的"),s("strong",[a._v("相同目录")]),a._v("，可使用脚本一键拷贝")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/scp-host.sh\n")])])]),s("ul",[s("li",[a._v("集群操作脚本")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 一键启动集群")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/start-all.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 一键停止集群")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/stop-all.sh\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 手动启停单个服务")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/dbapi-daemon.sh start gateway\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/dbapi-daemon.sh start manager\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/dbapi-daemon.sh start apiServer\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/dbapi-daemon.sh stop gateway\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/dbapi-daemon.sh stop manager\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/dbapi-daemon.sh stop apiServer\n\n")])])]),s("ul",[s("li",[a._v("浏览器访问"),s("code",[a._v("http://192.168.xx.xx:8523")]),a._v("进入UI; API通过gateway来访问"),s("code",[a._v("http://192.168.xx.xx:8525/api/xx")])])]),a._v(" "),s("h2",{attrs:{id:"docker部署单机版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker部署单机版"}},[a._v("#")]),a._v(" docker部署单机版")]),a._v(" "),s("blockquote",[s("p",[a._v("建议先阅读"),s("RouterLink",{attrs:{to:"/zh/guide/#监控"}},[a._v("日志监控")]),a._v("，便于理解docker每个环境变量的含义，理解启动的时候是否需要配置相应的环境变量")],1)]),a._v(" "),s("blockquote",[s("p",[a._v("Docker 容器通过环境变量进行配置，"),s("RouterLink",{attrs:{to:"/zh/install/#环境变量"}},[a._v("附录-环境变量")]),a._v("列出了 "),s("code",[a._v("DBApi")]),a._v(" 的可配置环境变量及其默认值")],1)]),a._v(" "),s("ul",[s("li",[a._v("一键启动（使用dbapi自带的元数据库sqlite，且不能使用日志监控功能）")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8520")]),a._v(":8520 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" dbapi freakchicken/db-api:3.2.0 standalone\n")])])]),s("ul",[s("li",[a._v("如果需要使用监控功能，还要配置日志数据库地址，以及将日志写入日志数据库")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8520")]),a._v(":8520 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ACCESS_LOG_WRITER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"db"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:clickhouse://127.0.0.1:8123/default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"123456"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ru.yandex.clickhouse.ClickHouseDriver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" dbapi "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\nfreakchicken/db-api:3.2.0 standalone\n")])])]),s("ul",[s("li",[a._v("如果使用自己的mysql作为元数据库（启动前需要在mysql执行初始化脚本）")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8520")]),a._v(":8520 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&characterEncoding=UTF-8&serverTimezone=GMT%2B8"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"com.mysql.cj.jdbc.Driver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ACCESS_LOG_WRITER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"db"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:clickhouse://127.0.0.1:8123/default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"123456"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ru.yandex.clickhouse.ClickHouseDriver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\nfreakchicken/db-api:3.2.0 standalone\n")])])]),s("ul",[s("li",[a._v("如果需要将API访问日志写入kafka，还需要配置kafka相关配置")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8520")]),a._v(":8520 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&characterEncoding=UTF-8&serverTimezone=GMT%2B8"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"com.mysql.cj.jdbc.Driver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ACCESS_LOG_WRITER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kafka"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ACCESS_LOG_KAFKA_TOPIC")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"dbapi_access_log"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ACCESS_LOG_KAFKA")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:9092"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:clickhouse://127.0.0.1:8123/default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"123456"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ru.yandex.clickhouse.ClickHouseDriver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\nfreakchicken/db-api:3.2.0 standalone\n")])])]),s("ul",[s("li",[a._v("浏览器访问"),s("code",[a._v("http://192.168.xx.xx:8520")]),a._v("进入UI")])]),a._v(" "),s("h2",{attrs:{id:"docker部署集群版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker部署集群版"}},[a._v("#")]),a._v(" docker部署集群版")]),a._v(" "),s("blockquote",[s("p",[a._v("建议先阅读"),s("RouterLink",{attrs:{to:"/zh/guide/#监控"}},[a._v("日志监控")]),a._v("，便于理解docker每个环境变量的含义，理解启动的时候是否需要配置相应的环境变量")],1)]),a._v(" "),s("blockquote",[s("p",[a._v("Docker 容器通过环境变量进行配置，"),s("RouterLink",{attrs:{to:"/zh/install/#环境变量"}},[a._v("附录-环境变量")]),a._v("列出了 "),s("code",[a._v("DBApi")]),a._v(" 的可配置环境变量及其默认值")],1)]),a._v(" "),s("ul",[s("li",[a._v("集群部署依赖"),s("code",[a._v("nacos")]),a._v("、"),s("code",[a._v("mysql")]),a._v("、"),s("code",[a._v("redis")]),a._v("，请先自行安装"),s("code",[a._v("nacos")]),a._v("（推荐1.4.2版本）、"),s("code",[a._v("mysql")]),a._v("、"),s("code",[a._v("redis")])]),a._v(" "),s("li",[a._v("在mysql创建新的数据库，执行数据库初始化脚本（下载安装包解压获取"),s("code",[a._v("sql/ddl_mysql.sql")]),a._v("脚本）")])]),a._v(" "),s("h3",{attrs:{id:"启动ui服务manager"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动ui服务manager"}},[a._v("#")]),a._v(" 启动UI服务manager")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8523")]),a._v(":8523 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&characterEncoding=UTF-8&serverTimezone=GMT%2B8"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"com.mysql.cj.jdbc.Driver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_ADDRESS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.xx.xx:8848"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nacos"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nacos"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_NAMESPACE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"public"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_HOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6379")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_DATABASE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:clickhouse://127.0.0.1:8123/default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"123456"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ru.yandex.clickhouse.ClickHouseDriver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\nfreakchicken/db-api:3.2.0 manager\n")])])]),s("h3",{attrs:{id:"启动网关服务-gateway"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动网关服务-gateway"}},[a._v("#")]),a._v(" 启动网关服务 gateway")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8525")]),a._v(":8525 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&characterEncoding=UTF-8&serverTimezone=GMT%2B8"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"com.mysql.cj.jdbc.Driver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_ADDRESS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.xx.xx:8848"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nacos"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nacos"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_NAMESPACE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"public"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_HOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6379")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_DATABASE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\nfreakchicken/db-api:3.2.0 gateway\n")])])]),s("h3",{attrs:{id:"启动api服务apiserver"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动api服务apiserver"}},[a._v("#")]),a._v(" 启动API服务apiServer")]),a._v(" "),s("blockquote",[s("p",[a._v("此服务可启动多个，构建api集群")])]),a._v(" "),s("ul",[s("li",[a._v("API访问日志直接写入日志数据库方式")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&characterEncoding=UTF-8&serverTimezone=GMT%2B8"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"com.mysql.cj.jdbc.Driver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_ADDRESS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.xx.xx:8848"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nacos"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nacos"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_NAMESPACE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"public"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_HOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6379")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_DATABASE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ACCESS_LOG_WRITER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"db"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:clickhouse://127.0.0.1:8123/default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"123456"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ru.yandex.clickhouse.ClickHouseDriver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\nfreakchicken/db-api:3.2.0 apiServer\n")])])]),s("ul",[s("li",[a._v("如果需要将API访问日志写入kafka，还需要配置kafka相关配置")])]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:mysql://192.168.xx.xx:3306/dbapi?useSSL=false&characterEncoding=UTF-8&serverTimezone=GMT%2B8"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"root"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"com.mysql.cj.jdbc.Driver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_ADDRESS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.xx.xx:8848"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nacos"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nacos"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("NACOS_NAMESPACE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"public"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_HOST")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6379")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_DATABASE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("REDIS_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ACCESS_LOG_WRITER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"kafka"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ACCESS_LOG_KAFKA_TOPIC")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"dbapi_access_log"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ACCESS_LOG_KAFKA")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"127.0.0.1:9092"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_URL")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"jdbc:clickhouse://127.0.0.1:8123/default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"default"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"123456"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LOG_DB_DRIVER")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ru.yandex.clickhouse.ClickHouseDriver"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\nfreakchicken/db-api:3.2.0 apiServer\n")])])]),s("ul",[s("li",[a._v("浏览器访问"),s("code",[a._v("http://192.168.xx.xx:8523")]),a._v("进入UI; API通过gateway来访问"),s("code",[a._v("http://192.168.xx.xx:8525/api/xx")])])]),a._v(" "),s("h2",{attrs:{id:"附录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[a._v("#")]),a._v(" 附录")]),a._v(" "),s("h3",{attrs:{id:"环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[a._v("#")]),a._v(" 环境变量")]),a._v(" "),s("blockquote",[s("p",[a._v("Docker部署的时候通过以下环境变量来传递参数")])]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("环境变量")]),a._v(" "),s("th",[a._v("默认值")]),a._v(" "),s("th",[a._v("说明")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("API_CONTEXT")]),a._v(" "),s("td",[a._v("api")]),a._v(" "),s("td",[a._v("所有API的统一根路径")])]),a._v(" "),s("tr",[s("td",[a._v("DB_URL")]),a._v(" "),s("td",[a._v("jdbc:sqlite::resource:sqlite.db")]),a._v(" "),s("td",[a._v("元数据库地址")])]),a._v(" "),s("tr",[s("td",[a._v("DB_USERNAME")]),a._v(" "),s("td"),a._v(" "),s("td",[a._v("元数据库账户")])]),a._v(" "),s("tr",[s("td",[a._v("DB_PASSWORD")]),a._v(" "),s("td"),a._v(" "),s("td",[a._v("元数据库密码")])]),a._v(" "),s("tr",[s("td",[a._v("DB_DRIVER")]),a._v(" "),s("td",[a._v("org.sqlite.JDBC")]),a._v(" "),s("td",[a._v("元数据库地址jdbc驱动")])]),a._v(" "),s("tr",[s("td",[a._v("NACOS_ADDRESS")]),a._v(" "),s("td",[a._v("127.0.0.1:8848")]),a._v(" "),s("td",[a._v("集群模式使用的nacos地址")])]),a._v(" "),s("tr",[s("td",[a._v("NACOS_USERNAME")]),a._v(" "),s("td",[a._v("nacos")]),a._v(" "),s("td",[a._v("集群模式使用的nacos账户")])]),a._v(" "),s("tr",[s("td",[a._v("NACOS_PASSWORD")]),a._v(" "),s("td",[a._v("nacos")]),a._v(" "),s("td",[a._v("集群模式使用的nacos密码")])]),a._v(" "),s("tr",[s("td",[a._v("NACOS_NAMESPACE")]),a._v(" "),s("td",[a._v("public")]),a._v(" "),s("td",[a._v("集群模式使用的nacos namespace")])]),a._v(" "),s("tr",[s("td",[a._v("REDIS_HOST")]),a._v(" "),s("td",[a._v("127.0.0.1")]),a._v(" "),s("td",[a._v("集群模式使用的redis地址")])]),a._v(" "),s("tr",[s("td",[a._v("REDIS_PORT")]),a._v(" "),s("td",[a._v("6379")]),a._v(" "),s("td",[a._v("集群模式使用的redis端口")])]),a._v(" "),s("tr",[s("td",[a._v("REDIS_DATABASE")]),a._v(" "),s("td",[a._v("0")]),a._v(" "),s("td",[a._v("集群模式使用的redis数据库号")])]),a._v(" "),s("tr",[s("td",[a._v("REDIS_PASSWORD")]),a._v(" "),s("td"),a._v(" "),s("td",[a._v("集群模式使用的redis密码")])]),a._v(" "),s("tr",[s("td",[a._v("LOG_DB_URL")]),a._v(" "),s("td",[a._v("jdbc:clickhouse://127.0.0.1:8123/default")]),a._v(" "),s("td",[a._v("日志数据库地址")])]),a._v(" "),s("tr",[s("td",[a._v("LOG_DB_USERNAME")]),a._v(" "),s("td",[a._v("default")]),a._v(" "),s("td",[a._v("日志数据库账户")])]),a._v(" "),s("tr",[s("td",[a._v("LOG_DB_PASSWORD")]),a._v(" "),s("td",[a._v("123456")]),a._v(" "),s("td",[a._v("日志数据库密码")])]),a._v(" "),s("tr",[s("td",[a._v("LOG_DB_DRIVER")]),a._v(" "),s("td",[a._v("ru.yandex.clickhouse.ClickHouseDriver")]),a._v(" "),s("td",[a._v("日志数据库地址jdbc驱动")])]),a._v(" "),s("tr",[s("td",[a._v("ACCESS_LOG_WRITER")]),a._v(" "),s("td",[a._v("null")]),a._v(" "),s("td",[a._v("API访问日志写入数据库的方式")])]),a._v(" "),s("tr",[s("td",[a._v("ACCESS_LOG_KAFKA_TOPIC")]),a._v(" "),s("td",[a._v("dbapi_access_log")]),a._v(" "),s("td",[a._v("API访问日志写入的Kafka的topic")])]),a._v(" "),s("tr",[s("td",[a._v("ACCESS_LOG_KAFKA")]),a._v(" "),s("td",[a._v("127.0.0.1:9092")]),a._v(" "),s("td",[a._v("API访问日志写入的Kafka的地址")])])])]),a._v(" "),s("h3",{attrs:{id:"docker快速安装nacos"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker快速安装nacos"}},[a._v("#")]),a._v(" docker快速安装nacos")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("docker run --env MODE=standalone --name nacos -d -p 8848:8848 nacos/nacos-server:1.4.2\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);